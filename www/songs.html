<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Music</title>
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
<link rel="stylesheet" type="text/css" href="/inc/main.css">

<body>

<!--#include file="/api/header.pht" -->

<main>
<article>
    <section class="col2">
        <div>
            <h1>Music</h1>
            <a href="/music" class="more">Releases</a>
        </div>
        <div>
            <img src="/photo/ab6761670000ecd44440e04613026131c7dc3f6e.jpeg">
        </div>
    </section>
</article>
</main>

<script type="text/javascript" src="/inc/Aerophane.js"></script>
<script type="text/javascript" src="/inc/main.js"></script>
<script>
function songHasStuff(song) {
    if (song.desc || song.lyrics) {
        return true;
    }
    if (song.audio.spotify || song.audio.youtube) {
        return true;
    }
    if (song.video.youtube || song.video.fb) {
        return true;
    }
    return false;
}

function showSongs(songData) {
    var shows = document.querySelector("main > article");
    var section = document.createElement("section");

    songData.forEach(function (song) {
        var h3 = document.createElement("h3");
        // only link if more than name, artist, and duration (and genres)
        // That's desc, lyrics, audio, video
        var a = document.createElement("a");
        var artist = document.createElement("span");
        if (songHasStuff(song)) {
            a.href = `/song?id=${song.id}`;
            a.textContent = song.name;
            h3.appendChild(a);
            artist.textContent = ` (${song.artist || bandName})`;
            h3.appendChild(artist);
        } else {
            h3.textContent = song.name;
            artist.textContent = ` (${song.artist || bandName})`;
        }
        section.appendChild(h3);
    });

    shows.appendChild(section);
}

setTitle(function () {
    getJsonData("/api/song", showSongs);
});
</script>
