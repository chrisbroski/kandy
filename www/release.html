<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Release - Kandy Fredrick</title>
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
<meta property="og:image" content="/img/kandy-og-img.jpg" />
<link rel="stylesheet" type="text/css" href="/inc/main.css">
<style>
iframe.spotify-player-sm {
    margin: 12px 0;
    max-width: 300px;
}
section.col2 div p > a > img {
    margin: 0;
    width: 24px;
    height: 24px;
    vertical-align: top;
}
section.col2 div p > a {
    font-weight: bold;
}
</style>
<body>

<main>
<article>
    <section class="col2">
        <div>
            <h1>Release</h1>
            <a href="/songs" class="more">All Songs</a>
        </div>
        <div>
            <img src="/photo/ab6761670000ecd44440e04613026131c7dc3f6e.jpeg">
        </div>
    </section>
</article>
</main>

<script type="text/javascript" src="/inc/showdown.min.js"></script>
<script type="text/javascript" src="/inc/main.js"></script>
<script>

function showRelease(release) {
    var article = document.querySelector("main article");
    var section = document.createElement("section");
    section.className = 'col2';
    var div = document.createElement("div");
    var a;

    var h2 = document.createElement("h2");
    var releaseName = release.name;
    if (!releaseName) {
        releaseName = release.songs[0].name;
    }
    if (release.songs.length === 1) {
        a = document.createElement("a");
        a.href = `/song?id=${release.songs[0].id}`;
        a.textContent = releaseName;
        h2.appendChild(a);
    } else {
        h2.textContent = releaseName;
    }
    div.appendChild(h2);
    var h3 = document.createElement("h3");
    h3.appendChild(dateFormat(new Date(Date.parse(release.date))));
    div.appendChild(h3);

    var template = document.createElement("template");
    if (release.desc) {
        template.innerHTML = converter.makeHtml(release.desc);
        div.appendChild(template.content);
    }

    // audio embed
    if (release.audio.spotify) {
        div.appendChild(embedSpotifyPlayer(extractSpotifyTrackId(release.audio.spotify), "album"));
    } else if (release.songs.length === 1) {
        div.appendChild(embedSpotifyPlayer(extractSpotifyTrackId(release.songs[0].audio.spotify), "track"));
    }
    var p;
    var icon;
    if (release.songs.length === 1) {
        if (release.songs[0].lyrics) {
            p = document.createElement("p");
            a = document.createElement("a");
            a.href = `/song?id=${release.songs[0].id}#lyrics`;
            a.title = "Lyrics";
            icon = document.createElement("img");
            icon.src = "/img/social/lyrics.svg";
            icon.className = "icon";
            a.appendChild(icon);
            p.appendChild(a);
            p.appendChild(document.createTextNode(" "));

            a = document.createElement("a");
            a.href = `/song?id=${release.songs[0].id}#lyrics`;
            a.title = "Lyrics";
            a.textContent = "Lyrics";
            p.appendChild(a);
            div.appendChild(p);
        }
        if (release.songs[0].video) {
            if (release.songs[0].video.youtube) {
                p = document.createElement("p");
                a = document.createElement("a");
                a.href = release.songs[0].video.youtube;
                a.title = "Watch on YouTube";
                icon = document.createElement("img");
                icon.src = "/img/social/youtube.svg";
                icon.className = "icon";
                a.appendChild(icon);
                p.appendChild(a);
                p.appendChild(document.createTextNode(" "));

                a = document.createElement("a");
                a.href = release.songs[0].video.youtube;
                a.title = "Watch on YouTube";
                a.textContent = "YouTube video";
                p.appendChild(a);
                div.appendChild(p);
            }
            if (release.songs[0].video.fb) {
                p = document.createElement("p");
                a = document.createElement("a");
                a.href = release.songs[0].video.fb;
                a.title = "Watch on Facebook";
                icon = document.createElement("img");
                icon.src = "/img/social/facebook-video.svg";
                a.appendChild(icon);
                p.appendChild(a);
                p.appendChild(document.createTextNode(" "));

                a = document.createElement("a");
                a.href = release.songs[0].video.fb;
                a.title = "Watch on Facebook";
                a.textContent = "Facebook video";
                p.appendChild(a);
                div.appendChild(p);
            }
        }
    }
    section.appendChild(div);

    div = document.createElement("div");
    var img;
    if (release["cover-front"]) {
        img = document.createElement("img");
        img.src = `/photo/${release["cover-front"]}`;
        div.appendChild(img);
    }
    if (release["cover-back"]) {
        img = document.createElement("img");
        img.src = `/photo/${release["cover-back"]}`;
        div.appendChild(img);
    }
    section.appendChild(div);
    article.appendChild(section);

    var p;
    if (release.songs.length > 1) {
        section = document.createElement("section");
        h2 = document.createElement("h2");
        h2.textContent = "Track List";
        section.appendChild(h2);

        release.songs.forEach(s => {
            p = document.createElement("p");
            a = document.createElement("a");
            a.href = `/song?id=${s.id}`;
            a.textContent = s.name;
            p.appendChild(a);
            section.appendChild(p);
        });
        article.appendChild(section);
    }

    if (release.video && (release.video.fb || release.video.youtube)) {
        section = document.createElement("section");
        h2 = document.createElement("h2");
        h2.textContent = "Videos";
        section.appendChild(h2);

        if (release.video.fb) {
            section.appendChild(embedFbPlayer(release.video.fb));
        }
        if (release.video.youtube) {
            section.appendChild(embedYtPlayer(release.video.youtube));
        }
        article.appendChild(section);
    }

    var pre;
    if (release.credits) {
        section = document.createElement("section");
        h2 = document.createElement("h2");
        h2.textContent = "Credits";
        section.appendChild(h2);
        pre = document.createElement("pre");
        pre.textContent = release.credits;
        section.appendChild(pre);
        article.appendChild(section);
    }
}

setTitle(function () {
    getJsonData(`/api/release/${querystring("id")}`, showRelease);
});
</script>
<!-- Go to www.addthis.com/dashboard to customize your tools --> <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-625ee32c3cd9d087"></script>
